# 项目说明

## 项目概述

这是一个名为SpaceMine的Python项目，使用Flask框架构建。
项目完全参考网站 https://ccyzz.com/ui/ ，页面结构及内容也均与该网站完全一致，如有页面描述不清楚的，可以自行查看该网站页面元素、逻辑、风格等
以后说参考网站就是指这个网站

数据库使用docker部署的mysql
数据库管理禁止自行建表，必须统一使用alembic统一进行数据库表管理，包括测试库、开发库和生产库

参考网站登录方式：
- 登录API：POST /api/login
- 请求体：JSON格式，包含username、password（SHA-256哈希）、nonce（16字节随机hex）、ts（时间戳）
- 成功后设置X-Session-Token cookie访问后续页面

## 项目模块需求

项目有以下模块，具体模块需求在对应模块名称的文档中，如用户管理模块的需求在用户管理模块.md的文件：
- 用户管理模块
- 信用卡充值模块
- 充值记录模块
- 管理员模块
- 能量提现模块

## 目录结构

```
SpaceMine/
├── app.py                    # 主应用程序文件
├── config.py                 # 配置文件
├── README.md                 # 项目README文档
├── requirements.txt          # Python依赖文件
├── scripts/                  # 脚本目录
│   ├── run.sh                # 本地运行脚本
│   ├── start.sh              # Docker启动脚本
│   ├── stop.sh               # Docker停止脚本
│   ├── restart.sh            # Docker重启脚本
│   └── encode_js.py          # JS文件编码脚本
├── cookies.txt               # Cookie文件
├── data/                     # 初始化数据目录
│   ├── create_admin.py       # 创建管理员脚本
│   ├── init_admin_user.py    # 初始化管理员用户脚本
│   ├── init_config.py        # 初始化配置脚本
│   ├── init_mining_rules.py  # 挖掘规则初始化脚本
│   └── init_roles.py         # 初始化角色脚本
├── docs/                     # 文档目录
│   ├── 信用卡充值模块.md       # 信用卡充值模块需求文档
│   ├── 充值记录模块.md         # 充值记录模块需求文档
│   ├── 用户管理模块.md         # 用户管理模块需求文档
│   ├── 管理员模块.md           # 管理员模块需求文档
│   ├── 能量提现模块.md         # 能量提现模块需求文档
│   └── 项目说明.md            # 项目说明文档
├── handlers/                 # 处理程序目录
│   ├── __init__.py
│   ├── auth.py                # 用户认证处理
│   ├── balance.py             # 用户余额处理
│   ├── invite.py              # 邀请系统处理
│   ├── messages.py            # 消息处理
│   ├── mine.py                # 挖矿处理
│   ├── notice.py              # 通知处理
│   ├── recharge.py            # 充值处理
│   ├── security.py            # 安全处理
│   ├── support.py             # 客服支持处理
│   └── withdraw.py            # 提现处理
├── migrations/               # 数据库迁移目录
│   ├── alembic.ini           # Alembic配置文件
│   ├── env.py                # Alembic环境配置
│   ├── README                # Alembic说明文档
│   ├── script.py.mako        # Alembic脚本模板
│   └── versions/             # 迁移版本文件
│       └── bbb32a858580_initial_migration.py
├── models/                   # 数据模型目录
│   ├── __init__.py           # 模型初始化文件
│   ├── config.py             # 配置模型
│   ├── credit_card.py        # 信用卡模型
│   ├── credit_card_generation_record.py  # 信用卡生成记录模型
│   ├── file.py               # 文件模型
│   ├── mine_user_relation.py # 挖矿用户关系模型
│   ├── mining_rule.py        # 挖矿规则模型
│   ├── notice.py             # 通知模型
│   ├── notification.py       # 消息通知模型
│   ├── recharge.py           # 充值模型
│   ├── user.py               # 用户模型
│   └── withdrawal.py         # 提现模型
├── routes/                   # 路由目录
│   ├── __init__.py
│   ├── admin.py              # 管理员路由
│   ├── auth.py               # 认证路由
│   ├── dashboard.py          # 仪表板路由
│   ├── invite.py             # 邀请路由
│   ├── notice.py             # 通知路由
│   ├── recharge.py           # 充值路由
│   ├── ui.py                 # UI路由
│   ├── user.py               # 用户路由
│   └── withdraw.py           # 提现路由
├── static/                   # 静态文件目录
│   ├── css/                  # CSS样式文件
│   │   ├── home.css
│   │   ├── style.css
│   │   └── style_ref.css
│   ├── img/                  # 图片文件
│   │   ├── 1.png
│   │   ├── 2.png
│   │   ├── 3.png
│   │   ├── 18.png
│   │   ├── b1.jpg
│   │   ├── b2.png
│   │   ├── b3.png
│   │   ├── b4.jpg
│   │   ├── btbg.png
│   │   ├── i9.png
│   │   ├── i51.png
│   │   ├── i56.png
│   │   ├── i65.gif
│   │   ├── k1.png
│   │   ├── k2.png
│   │   ├── k3.png
│   │   ├── k4.png
│   │   ├── k5.png
│   │   ├── kg.jpg
│   │   ├── login_bg.png
│   │   └── nl.jpg
│   ├── js/                   # JavaScript文件
│   │   ├── account_security.page.js
│   │   ├── dashboard.js
│   │   ├── invite.js
│   │   ├── login.js
│   │   ├── recharge.js
│   │   ├── recharge_card.js
│   │   ├── recharge_history.js
│   │   ├── recharge_usdt.js
│   │   ├── register.js
│   │   ├── ui.js
│   │   └── withdraw.page.js
│   └── static/               # 静态子目录
│       └── img/              # 静态图片子目录
├── templates/                # HTML模板目录
│   ├── admin.html            # 管理员页面
│   ├── dashboard.html        # 仪表板页面
│   ├── intro.html            # 介绍页面
│   ├── invite.html           # 邀请页面
│   ├── login.html            # 登录页面
│   ├── notices.html          # 通知页面
│   ├── recharge_card.html    # 信用卡充值页面
│   ├── recharge_history.html # 充值记录页面
│   ├── recharge_usdt.html    # USDT充值页面
│   ├── recharge.html         # 充值页面
│   ├── register.html         # 注册页面
│   ├── security.html         # 安全设置页面
│   └── withdraw.html         # 提现页面
├── tests/                    # 测试目录
│   ├── __init__.py
│   ├── conftest.py
│   ├── test_recharge_handlers.py
│   ├── test_user_handlers.py
│   └── test_user_routes.py
└── utils/                    # 工具函数目录
```

## 主要组件说明

- **app.py**: 项目的主入口文件，包含Flask应用实例和基本配置。
- **config.py**: 项目配置文件，包含各种配置参数。
- **data/**: 存放初始化数据脚本，用于设置项目初始数据。
- **models/**: 定义数据模型和数据库相关代码。
- **routes/**: 定义应用程序的路由和视图函数。
- **handlers/**: 处理特定业务逻辑的模块。
- **static/**: 存放静态资源文件，如CSS、JavaScript和图片。
- **templates/**: 存放Jinja2模板文件，用于渲染HTML页面。
- **utils/**: 存放工具函数和辅助代码。
- **instance/**: 存放实例特定的配置和数据。
- **docs/**: 存放项目文档。
- **migrations/**: 存放数据库迁移文件，用于数据库版本管理。

## 依赖

项目依赖列在 `requirements.txt` 文件中，使用以下命令安装：

```
pip install -r requirements.txt
```

## 运行项目

### Docker方式（推荐）
```bash
# 一键启动（包含初始化）
./scripts/start.sh

# 重启服务
./scripts/restart.sh

# 停止服务
./scripts/stop.sh
```

### 本地开发方式
```bash
# 运行项目
./scripts/run.sh
```
