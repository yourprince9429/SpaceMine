# 能量提现模块

## 页面位置
- 路径：`/ui/withdraw`
- 入口：首页 -> 我的 -> 常用功能 -> 能量提现

## 页面结构

### 1. 标签页切换
- 两个标签页：
  - USDT提现（默认激活）
  - 银行卡提现

### 2. 可提现能量显示
- 显示用户当前可提现的能量余额
- 显示格式：保留2位小数

### 3. USDT提现表单
- **USDT地址输入框**
  - placeholder: "請輸入USDT接收地址"
  
- **网络类型选择**
  - 两个按钮：TRC20、ERC20
  - 默认选中：TRC20
  - 点击切换网络类型
  
- **提现能量输入框**
  - placeholder: "提現能量"
  - 右侧有"全部"按钮，点击后填入全部可提现能量
  
- **交易密码输入框**
  - type="password" readonly
  - placeholder: "交易密碼（6位數字）"
  - 点击后弹出数字键盘输入
  
- **提示信息**
  - 提现比例：1能量≈1USDT｜预计到账：[实际金额] USDT
  
- **操作按钮**
  - 返回按钮：跳转到 `/ui/?tab=user`
  - 提交提现申请按钮
  
- **待审核提示**
  - 当存在待审核申请时显示："存在待审核申请，暂不可再次提交"
  - 提交按钮被禁用，透明度降低到0.6
  
- **提现说明**
  - 请确保USDT地址准确无误，转账后无法撤回
  - 提现申请提交后，将在1-24小时内审核
  - 审核通过后，会在1-3个工作日内到账
  - 发起提现申请后能量将被暂时冻结

### 4. 银行卡提现表单
- **账户名输入框**
  - placeholder: "帳戶名"
  
- **银行卡号输入框**
  - placeholder: "銀行卡號"
  
- **银行名称输入框**
  - placeholder: "銀行名稱（例如：台灣銀行）"
  
- **银行代码输入框**
  - placeholder: "銀行代碼"
  
- **提现能量输入框**
  - placeholder: "提現能量"
  - 右侧有"全部"按钮
  
- **交易密码输入框**
  - type="password" readonly
  - placeholder: "交易密碼（6位數字）"
  - 点击后弹出数字键盘输入
  
- **提示信息**
  - 提现比例：1能量≈$1｜预计到账：[实际金额]
  
- **操作按钮**
  - 返回按钮：跳转到 `/ui/?tab=user`
  - 提交提现申请按钮
  
- **待审核提示**
  - 当存在待审核申请时显示："存在待审核申请，暂不可再次提交"
  - 提交按钮被禁用，透明度降低到0.6
  
- **提现说明**
  - 请确保银行卡资讯准确，避免到账失败
  - 提现申请提交后，将在1-24小时内审核
  - 审核通过后，会在1-3个工作日内到账
  - 发起提现申请后能量将被暂时冻结

### 5. 提现记录
- **筛选按钮**
  - 全部（默认激活）
  - 待审核
  - 已通过
  - 已拒绝
  
- **记录列表**
  - 每条记录显示：
    - 左侧：
      - 类型名称（USDT提现 或 银行卡提现）
      - 创建时间
    - 右侧：
      - 提现金额（保留2位小数）
      - 状态标签（已通过/待审核/已拒绝）
  
- **空状态**
  - 没有记录时显示："暂无提现记录"

### 6. 返回按钮
- 位置：左下角固定
- 链接：`/ui/?tab=user`
- 文字："返回我的"

## API接口

### 1. 获取提现信息
**接口：** `GET /ui/api/withdraw/info`

**响应：**
```json
{
  "success": true,
  "available_food": 100.50,
  "mobile": "138****8888",
  "pending_count": 0
}
```

### 2. 获取提现记录列表
**接口：** `GET /ui/api/withdraw/list?status={status}`

**参数：**
- status: 可选，值为 all/pending/success/fail，默认为 all

**响应：**
```json
{
  "success": true,
  "list": [
    {
      "id": 1,
      "type_name": "USDT提现",
      "amount": 100.00,
      "status": "success",
      "status_text": "已通过",
      "created_at": "2026-01-26 12:00:00"
    }
  ]
}
```

### 3. 提交USDT提现申请
**接口：** `POST /ui/withdraw/usdt`

**请求体：**
```json
{
  "address": "USDT地址",
  "network": "TRC20",
  "amount": 100.00,
  "pay_password": "加密后的交易密码"
}
```

**响应：**
```json
{
  "success": true,
  "order_id": "订单号"
}
```

### 4. 提交银行卡提现申请
**接口：** `POST /ui/withdraw/bank`

**请求体：**
```json
{
  "holder": "账户名",
  "card": "银行卡号",
  "bank": "银行名称",
  "code": "银行代码",
  "amount": 100.00,
  "pay_password": "加密后的交易密码"
}
```

**响应：**
```json
{
  "success": true,
  "order_id": "订单号"
}
```

## 交互逻辑

### 1. 页面初始化
- 加载提现信息（可提现能量、手机号、待审核数量）
- 根据待审核数量控制提交按钮状态
- 加载提现记录列表（默认显示全部）

### 2. 标签页切换
- 点击标签页切换显示对应表单
- 切换时保持输入框内容

### 3. 网络类型选择
- 点击TRC20或ERC20按钮切换网络类型
- 只能选择一个，高亮显示选中状态

### 4. 全部按钮
- 点击"全部"按钮，将可提现能量填入提现能量输入框
- 使用Math.floor向下取整

### 5. 交易密码输入
- 点击交易密码输入框弹出数字键盘
- 数字键盘包含：
  - 0-9数字按钮
  - 删除按钮（⌫）
  - 清空按钮（✕）
  - 取消按钮
  - 确认按钮
- 输入时显示6个圆点，已输入的显示实心
- 点击确认时验证是否为6位数字
- 验证通过后将密码填入输入框并关闭键盘

### 6. 表单验证
**USDT提现：**
- USDT地址不能为空
- 提现能量必须大于0且为整数
- 不能超过可提现能量
- 交易密码必须为6位数字

**银行卡提现：**
- 账户名、银行卡号、银行名称、银行代码都不能为空
- 提现能量必须大于0且为整数
- 不能超过可提现能量
- 交易密码必须为6位数字

### 7. 提交提现申请
- 验证通过后加密交易密码
- 发送请求到对应API
- 成功后显示成功提示
- 重新加载提现信息和记录列表
- 清空表单

### 8. 记录筛选
- 点击筛选按钮切换显示不同状态的记录
- 高亮显示当前选中的筛选按钮

## 密码加密
- 使用SHA-256算法加密交易密码
- 加密格式：SHA256(mobile + ":" + password)
- 使用crypto-js库的crypto.subtle.digest方法

## 提现记录状态
- pending: 待审核
- success: 已通过
- fail: 已拒绝

## 提现类型
- USDT提现
- 银行卡提现

## 注意事项
1. 存在待审核申请时，不允许再次提交
2. 提现能量必须为整数
3. 交易密码必须为6位数字
4. USDT提现支持TRC20和ERC20两种网络
5. 银行卡提现需要完整的银行卡信息
